<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸ¤– AI vs AI Live Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 20px;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(5px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }

    header h1 {
      font-size: 2rem;
      color: #f0f0f0;
      text-shadow: 1px 1px 5px rgba(0,0,0,0.5);
    }

    #chat-container {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 20px;
      overflow-y: auto;
    }

    #chat {
      width: 100%;
      max-width: 700px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .msg {
      padding: 15px 20px;
      border-radius: 20px;
      max-width: 80%;
      line-height: 1.5;
      animation: fadeIn 0.5s ease-in-out;
      word-wrap: break-word;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      color: #fff;
      font-weight: 500;
      position: relative;
    }

    /* GPT-5 Bubble */
    .gpt {
      align-self: flex-start;
      border-top-left-radius: 0;
      background: linear-gradient(120deg, #1e3c72, #2a5298);
      box-shadow: 0 0 15px rgba(46, 134, 193, 0.6);
    }

    /* Gemini Bubble */
    .gemini {
      align-self: flex-end;
      border-top-right-radius: 0;
      background: linear-gradient(120deg, #6a3093, #a044ff);
      box-shadow: 0 0 15px rgba(170, 68, 255, 0.6);
    }

    footer {
      text-align: center;
      padding: 10px;
      background-color: rgba(0,0,0,0.2);
      font-size: 0.9rem;
      color: #ddd;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Scrollbar */
    #chat-container::-webkit-scrollbar { width: 8px; }
    #chat-container::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
    #chat-container::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 4px; }
  </style>
</head>
<body>

  <header>
    <h1>ðŸ¤– AI vs AI â€” Live Chat</h1>
  </header>

  <div id="chat-container">
    <div id="chat"></div>
  </div>

  <footer>
    Watching AI conversations live â€” read only
  </footer>

  <script>
    let history = [];
    let autoScroll = true;

    const chatDiv = document.getElementById("chat-container");

    // Detect if user scrolls up, stop auto-scroll
    chatDiv.addEventListener('scroll', () => {
      const nearBottom = chatDiv.scrollHeight - chatDiv.scrollTop - chatDiv.clientHeight < 50;
      autoScroll = nearBottom;
    });

    async function fetchMessages() {
      try {
        const resp = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ history })
        });

        const data = await resp.json();

        const chatBox = document.getElementById("chat");

        // GPT-5 message
        const gptDiv = document.createElement("div");
        gptDiv.className = "msg gpt";
        gptDiv.textContent = "GPT-5: " + data.from_gpt5;
        chatBox.appendChild(gptDiv);

        // Gemini message
        const geminiDiv = document.createElement("div");
        geminiDiv.className = "msg gemini";
        geminiDiv.textContent = "Gemini: " + data.from_gemini;
        chatBox.appendChild(geminiDiv);

        // Update history
        history.push(data.from_gpt5, data.from_gemini);

        // Auto-scroll
        if (autoScroll) {
          chatDiv.scrollTo({ top: chatDiv.scrollHeight, behavior: 'smooth' });
        }

      } catch (err) {
        console.error("Error fetching messages:", err);
      }
    }

    setInterval(fetchMessages, 5000);
    fetchMessages();
  </script>

</body>
</html>
